---
title: "3_Linear_Regression_Part_2"
author: "T.A. Meraxa"
date: "August 20, 2016"
output: html_document
---

### 3.4 Factors, Interactions and Weights

Formula       | Description
------------  |------------
y ~ a + x     | Model without interaction: indentical slopes with respect to x, but different intercepts with respect to a.
Y ~ a* x      | Model with interaction: the term a:x gives the difference in slopes compared with the reference category.
y ~ a/x       | Model with interaction: produces the same fitten values as the mdoel above but using a nested coefficient coding. An explicit slope estimate is computed for each category in a.
y ~ (a+b+c)^2 | Model with all two-way interactions(excluding three way interaction).

#### Interactions

```{r}
# Let's consider an interaction between `ethnicity` and `education`
cps_int <- lm(log(wage) ~ experience + I(experience^2) + education * ethnicity, data = CPS1988)
coeftest(cps_int)
```

Resuts indicated that the interaction term is significant at the 5% level

#### Separate regression for each level

As a further variation, it may be necessary to fit separate regression for African-Americans and Caucasians. It can be computed using two separate `lm` objects

```{r}
cps_sep <- lm(log(wage) ~ ethnicity / (experience + I(experience^2) + education) -1, data = CPS1988)
summary(cps_sep)

# For compactness
cps_sep_cf <- matrix(coef(cps_sep), nrow =2)
rownames(cps_sep_cf) <- levels(CPS1988$ethnicity)
colnames(cps_sep_cf) <- names(coef(cps_lm))[1:4]
cps_sep_cf
```

This shows that the effects of education are similar for both groups, but the remaining coefficients are somewhat smaller in absolute size for African-Americans

```{r}
# A comparison of the new models with the first one yields
anova(cps_sep, cps_lm)
```

#### Change of reference category

In any regression containing unordered factor, R by default uses the first level of factor as the reference category. In `CPS1988`, `"cauc"` is the reference category for `ethnicity`, while `"northeast"` is the reference category for `region`. Bierens and Ginther (2001) employ `"south"` as the reference category for region. 

```{r}
CPS1988$region <- relevel(CPS1988$region, ref ="south")
cps_region <- lm(log(wage) ~ ethnicity + education + experience + I(experience^2) + region, data = CPS1988)
coef(cps_region)
```

#### Weighted least squared

Cross-section regressions are often plagued by heteroskedasticity. One of the remedies is to use weighted least squares (WLS)

```{r}
#add Journals data
data("Journals")
journals <- Journals[, c("subs", "price")]
journals$citeprice <- Journals$price/Journals$citations
summary(journals)

jour_wls1 <- lm(log(subs) ~ log(journals$citeprice), data = Journals, weights = 1/journals$citeprice^2)

jour_wls2 <- lm(log(subs) ~ log(journals$citeprice), data = Journals, weights = 1/journals$citeprice)

summary(jour_wls1)
summary(jour_wls2) # yields a regression with weights in the form 1/z[i]
```

plotting a comparison between OLS and WLS

```{r}
plot(log(subs) ~ log(citeprice), data = journals)
abline(jour_lm)
abline(jour_wls1, lwd = 2, lty = 2)
abline(jour_wls2, lwd = 2, lty = 3)
legend("bottomleft", c("OLS", "WLS1", "WLS2"), lty = 1:3, lwd = 2, bty = "n")
```

### 3.5 Linear Regression with Time Series Data

